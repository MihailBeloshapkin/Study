

ВКР 

Введение
	
	С развитем информационных технологий в повседевную жизнь совревенного человека 
	В современном мире многие люди ежедневно пользуются облачными хранилищами. Данные сервисы
	позволяют 
	  
	могут содержать ценную информацию об их владельце, которая может быть полезной для сотрудников
	силовых структур, криминалистов. Поэтому важно уметь правильно извлекать информацию, более того, этот
	процесс необходимо автоматизировать.
	
	Для специалистов, которые занимаются исследованиями в области цифровой криминалистики, занимаеют
	облачние сервисы, которые приобрели широкую популярность в последние годы. 



	Современная криминалистика имеет несколько направлений, одно из которых -- цифровая криминалистика.
	Данная область специализируется на извлечении и последующем анализе  данных с персональных компьютеров, 
	мобильных устройств, облачных хранилищ. Полученная таким образом информация может сыграть
	важную в роль в ходе проведения криминалистических экспертиз, или даже предотвратить преступления.

	Особую важность для экспертов в области цифровой криминалистики представляют набирающие в последние годы 
	популярность облачные сервисы. Они позволяют пользователям безопасно загружать и хранить различные данные
	на удаленных серверах, а некоторые сервисы также могут автоматически синхронизировать данные на авторизованных устройствах.
	В качестве примера можно привести встроенный в операционную систему iOS облачный сервис iCloud. Помимо хранения фотографий, видео-
	и аудиофайлов, заметок, контактов, резервных копий, в iCloud также реализован iCloud keychain -- приложение, 
	которое позволяет загружать пароли от различных аккаунтов, пароли от Wi-Fi сетей, а также номера банковских
	карт и другую конфеденциальную инфомацию, таким образом избавляя пользователя от необходимости запоминать их и вводить вручную
	при авторизации. Очевидно, что эти данные представляют особую ценность для их владельца, а, следовательно,
	и для специалистов, которые занимаются исследованиями в области цифровой криминалистики. Таким образом, возникает
	необходимость в автоматизации извлечения данных из iCloud keychain.

	Для экспорта и анализа данных из облачных хранилищ существует программный пакет Belkasoft X, разработанный компанией
	Belkasoft. В Belkasoft X есть модуль, который позволяет после авторизации в iCloud автоматически выгружать
	фотографии, данные электронной почты, заметки и даже резервные копии для устройств на операционной системе iOS, но
	на данный момент не реализовано извлечение данных iCloud keychain. Поэтому было принято решение реализовать инструмент,
	скачивания iCloud keychain с целью его последующего интегрирования в продукт Belkasoft X.


	 
	Постановка задачи

	Целью данной работы является реализация инструмента для извлечения данных keychain из облачного хранилища 
	iCloud в рамках продукта Belkasoft X. Для достижения этой цели были сформулированы следующие промежуточные
	задачи:
		- сделать обзор существующих решений
		- изучить схему общения встроенного систменого приложения с серверами
		- произвести реверсинг внутреннего API
		- изучить алгоритмы шифрования данных
		- реализовать инструмент для скачивания данных keychain из облачного сервиса iCloud
		- провести апробацию
		- интегрирвать реализованный инструмент в программный пакет Belkasoft X

	Обзор:
		На рынке программного обеспечения для цифровой криминалистики существует не так много
		решений, позволяющих извлекать данные iCloud. Можно отметить следующие решения:

		-- Elcomsoft phone breaker
			Elcomsoft phone breaker -- программыный комплекс, предоставляющий возможность
			извлечения различных данных iCloud, включая данные keychain. Код проекта является
			закрытым, поэтому у нас есть возможность познакомится лишь с его функциональностью.
			Данную информацию можно найти на официальном сайте, а также из выложенных в открытый
			доступ презентаций данного продукта. Для получения доступа к iCloud keychain требуется
			ввести следующие данные: Apple Id, пароль, код двухфакторной аутентификации, сгенерированный
			одним из авторизованных устройств, код блокировки или пароль от одного из авторизованных устройств,
			после чего происходит скачивание и дешифровка данных.





	Составление схемы запросов

	По условиям можно переиспользовать некоторые модули, отвечающие за авторизацию, но все же полезно 
	изучить то, как именно происходит общение системных приложений iOS и серверов Apple. 



	iOS 14.8

	Для снятия по последующего анализа сетевого трафика использовалось устройство на операционной
	системе iOS версии 14.8. Сначала трафик перехватывался с помощью инструмента Burp Suite,
	который позволяет сконфигурировать отлодочный прокси сервер. На устройстве требуется ввести
	ip адрес прокси сервера и порт, а также подтвердить сертификат, после чего можно перехватывать 
	HTTP трафик. Однако при данном подходе существует проблема, а именно используемый в системных
	программах iOS SSL-pinning. Суть SSL-pinning проблемы заключаетя в том, что SSL сертификат 
	сервера хранится непосредственно внутри приложения, таким образом делая его устойчивым в MITM-атакам.
	Решить данную проблему можно с помощью утилиты SSL-killswitch, которую можно установить при помощи 
	Cydia на устройство с прошивкой Jailbreak. Однако в нашем случае такая схема работает только
	с отключенной дешифровкой трафика на доменое имя https://setup.icloud.com. А нам в свою очередь необходимо
	получить полный дамп трафика, поэтому 


	Перехват трафика во время авторизации. 


	Веб версия iCloud
	Стоит отметить, что в браузерной версии пользователь доступ к очень ограниченному множеству
	данных, в частности, в веб версии нельзя просмотреть данные keychain. Однако исследования
	различных типов клиентов могут быть полезными в случае, когда у программы нет публичного API, так как
	в таком случае можно составить более подробоное представление о том, за что отвечают
	те или иные запросы. Для исследования трафика в веб версии использовался инструмент HttpToolkit.
	Удалось выяснить, что веб версия использует несколько иную схему авторизации, которая не предусматривает
	получение токенов для keychain, а значит интересующих нас данных там, естественно, не оказалось	 
